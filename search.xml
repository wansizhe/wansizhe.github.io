<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>阿里巴巴CVR预估模型：ESMM</title>
    <url>/2020/12/01/Alibaba-ESMM/</url>
    <content><![CDATA[<p>论文地址：<a href="https://arxiv.org/abs/1804.07931">Entire Space Multi-Task Model: An Eﬀective Approach for Estimating Post-Click Conversion Rate</a></p>
<h2 id="0x00-CVR与CTR的区别"><a href="#0x00-CVR与CTR的区别" class="headerlink" title="0x00 CVR与CTR的区别"></a>0x00 CVR与CTR的区别</h2><p>CTR是点击率，CVR是转化率，点击率问题非常直接，其含义只有两步：</p>
<ol>
<li>页面曝光</li>
<li>用户点击</li>
</ol>
<p>转化率中涉及的一般是转化为收益的行为，例如淘宝场景中的下单购买。转化率问题在业务逻辑上没有点击率问题那么简单，通常包含三步：</p>
<ol>
<li>页面曝光</li>
<li>用户点击</li>
<li>用户购买</li>
</ol>
<p><img src="/2020/12/01/Alibaba-ESMM/CTR和CVR的样本关系.png" alt="CTR和CVR的样本关系"></p>
<p>转化行为发生前，一定会出现点击行为，这是不可避免的。但是CVR预估问题，最终预估的概率不是“点击且转化”（这是CTCVR问题），而是“点击条件下转化”，这之间的区别和联系可以用下面这个式子表达</p>
<script type="math/tex; mode=display">
P\left(click,conversion\right) = P\left(click\right)P\left(conversion|click\right)</script><p>也就是</p>
<script type="math/tex; mode=display">
P_{CTCVR} = P_{CTR}\cdot P_{CVR}</script><p>所以不能使用全部的样本进行训练，假设样本由特征和标签组成，标签为1，代表成功转化，样本特征如果不做特别注明，那么就无法知道样本是否被点击过，这样训练的模型预测的是CTCVR，而不是CVR。联系实际场景，很多商品你没有购买的直接原因是你没有点击它，CVR预估模型需要预测一个物品假设你点击了，买的概率有多大。</p>
<p>从以上问题中梳理出以下两个重要问题：</p>
<ol>
<li>Sample Selection Bias（SSB）。通常CVR预估问题在模型训练时，提供的样本局限于被点击的记录，其中成功转化的作为正样本，没有转化的作为负样本。但是在预测时，是对所有样本进行预测，而不是对被点击的样本进行预测。样本的选择造成了模型的偏差。</li>
<li>Data Sparsity（DS）。当样本被局限于点击过的数据时，样本量会骤减，远不如CTR问题中曝光的数据量。</li>
</ol>
<h2 id="0x01-模型"><a href="#0x01-模型" class="headerlink" title="0x01 模型"></a>0x01 模型</h2><p><img src="/2020/12/01/Alibaba-ESMM/ESMM.png" alt="ESMM模型结构图"></p>
<p>这个模型体现出了CTCVR、CTR、CVR三者的关系，左边负责预测CVR，右边负责预测CTR，顶部通过相乘预测CTCVR。左侧CVR预估模型不直接参加计算损失函数，损失函数只包含CTR和CTCVR两部分</p>
<script type="math/tex; mode=display">
Loss\left(\theta_{ctr},\theta_{cvr}\right) = 
\sum_{i=1}^{N}{L\left(y_{i},f\left(x_{i};\theta_{ctr}\right)\right)}+
\sum_{i=1}^{N}{L\left(y_{i}\&z_{i},f\left(x_{i};\theta_{ctr}\right)\cdot f\left(x_{i};\theta_{cvr}\right)\right)}</script><p>这样设计，是因为CTR预估任务和CTCVR预估任务可以使用全部的样本，通过“曲线救国”的方式，绕开了CVR预估的样本问题。</p>
<h2 id="0x02-实验"><a href="#0x02-实验" class="headerlink" title="0x02 实验"></a>0x02 实验</h2><p>作者对比的模型如下</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">模型</th>
<th style="text-align:center">结构说明（逐渐复杂）</th>
<th style="text-align:center">训练样本（逐渐扩充）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">BASE</td>
<td style="text-align:center">仅CVR部分</td>
<td style="text-align:center">仅包含点击样本</td>
</tr>
<tr>
<td style="text-align:center">AMAN</td>
<td style="text-align:center">同上</td>
<td style="text-align:center">从未点击样本中采样作为负例加入</td>
</tr>
<tr>
<td style="text-align:center">OVERSAMPLING</td>
<td style="text-align:center">同上</td>
<td style="text-align:center">对正例（点击并转化）过采样</td>
</tr>
<tr>
<td style="text-align:center">UNBIAS</td>
<td style="text-align:center">同上</td>
<td style="text-align:center">加入rejection sampling</td>
</tr>
<tr>
<td style="text-align:center">DIVISION</td>
<td style="text-align:center">分别训练CTR和CTCVR，相除得CVR</td>
<td style="text-align:center">同上</td>
</tr>
<tr>
<td style="text-align:center">ESMM-NS</td>
<td style="text-align:center">ESMM模型，embedding层不共享参数</td>
<td style="text-align:center">同上</td>
</tr>
<tr>
<td style="text-align:center">ESMM</td>
<td style="text-align:center">完整的ESMM模型</td>
<td style="text-align:center">同上</td>
</tr>
</tbody>
</table>
</div>
]]></content>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2020/05/13/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
      <categories>
        <category>Introduction</category>
      </categories>
  </entry>
  <entry>
    <title>my first blog</title>
    <url>/2020/05/13/my-first-blog/</url>
    <content><![CDATA[<h3 id="this-is-my-first-hexo-blog"><a href="#this-is-my-first-hexo-blog" class="headerlink" title="this is my first hexo blog"></a>this is my first hexo blog</h3><a id="more"></a>
<p>$f(x)=\frac{P(x)}{Q(x)}$</p>
]]></content>
      <categories>
        <category>Introduction</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>next</tag>
      </tags>
  </entry>
</search>
